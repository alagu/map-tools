// Generated by CoffeeScript 1.8.0
var getBoundsZoomLevel, getParameterByName, initialize;

getParameterByName = function(name) {
  var regex, results;
  name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
  regex = new RegExp("[\\?&]" + name + "=([^&#]*)");
  results = regex.exec(location.search);
  if (results === null) {
    return "";
  } else {
    return decodeURIComponent(results[1].replace(/\+/g, " "));
  }
};

getBoundsZoomLevel = function(bounds, mapDim) {
  var WORLD_DIM, ZOOM_MAX, latFraction, latRad, latZoom, lngDiff, lngFraction, lngZoom, ne, sw, zoom;
  latRad = function(lat) {
    var radX2, sin;
    sin = Math.sin(lat * Math.PI / 180);
    radX2 = Math.log((1 + sin) / (1 - sin)) / 2;
    return Math.max(Math.min(radX2, Math.PI), -Math.PI) / 2;
  };
  zoom = function(mapPx, worldPx, fraction) {
    return Math.floor(Math.log(mapPx / worldPx / fraction) / Math.LN2);
  };
  WORLD_DIM = {
    height: 256,
    width: 256
  };
  ZOOM_MAX = 21;
  ne = bounds.getNorthEast();
  sw = bounds.getSouthWest();
  latFraction = (latRad(ne.lat()) - latRad(sw.lat())) / Math.PI;
  lngDiff = ne.lng() - sw.lng();
  lngFraction = (lngDiff < 0 ? lngDiff + 360 : lngDiff) / 360;
  latZoom = zoom(mapDim.height, WORLD_DIM.height, latFraction);
  lngZoom = zoom(mapDim.width, WORLD_DIM.width, lngFraction);
  return Math.min(latZoom, lngZoom, ZOOM_MAX);
};

initialize = function() {
  var bottom, i, latlngbounds, left, map, mapDim, mapDiv, mapOptions, right, squarePolygon, top, triangleCoords;
  top = getParameterByName("top") || 12.980802;
  bottom = getParameterByName("bottom") || 12.973776;
  left = getParameterByName("left") || 77.568855;
  right = getParameterByName("right") || 77.574424;
  triangleCoords = [new google.maps.LatLng(top, right), new google.maps.LatLng(top, left), new google.maps.LatLng(bottom, left), new google.maps.LatLng(bottom, right)];
  latlngbounds = new google.maps.LatLngBounds();
  i = 0;
  while (i < triangleCoords.length) {
    latlngbounds.extend(triangleCoords[i]);
    i++;
  }
  mapDiv = document.getElementById("map-canvas");
  mapDim = {
    height: mapDiv.clientHeight,
    width: mapDiv.clientWidth
  };
  mapOptions = {
    zoom: getBoundsZoomLevel(latlngbounds, mapDim),
    center: latlngbounds.getCenter()
  };
  squarePolygon = void 0;
  map = new google.maps.Map(mapDiv, mapOptions);
  squarePolygon = new google.maps.Polygon({
    paths: triangleCoords,
    strokeColor: "#0000FF",
    strokeOpacity: 0.7,
    strokeWeight: 1,
    fillColor: "#0000FF",
    fillOpacity: 0.1
  });
  squarePolygon.setMap(map);
};

google.maps.event.addDomListener(window, "load", initialize);
